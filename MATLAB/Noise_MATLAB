
s0 = 1000; 
s1 = 2000;
s2 = 3000; 
len = 640;
var = 0.79 ;
cw = [1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0,1, 0, 0, 1, 0];
bpsk = 	(cw*2)-1 ;
a = length(bpsk)

random = zeros(1,len);
int32_random = zeros(1,len);
for i = 1 : len 
    b1 = double(fix((bitsra(bitxor(bitsll(s0,13),s0),19))));
    s0 = bitxor(bitsll(bitand(s0,0xFFFFFFFF),12),b1);

    b1 = double(fix((bitsra(bitxor(bitsll(s1,2),s1),25))));
    s1 = bitxor(bitsll(bitand(s1,0xFFFFFFF8),4),b1);

    b1 = double(fix((bitsra(bitxor(bitsll(s2,3),s2),11))));
    s2 = bitxor(bitsll(bitand(s2,0xFFFFFFF0),17),b1) ;
    random1 = bitxor(bitxor(s0,s1),s2);


    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    b2 = double(fix((bitsra(bitxor(bitsll(s0,13),s0),19))));
    s0 = bitxor(bitsll(bitand(s0,0xFFFFFFFF),12),b2);

    b2 = double(fix((bitsra(bitxor(bitsll(s1,2),s1),25))));
    s1 = bitxor(bitsll(bitand(s1,0xFFFFFFF8),4),b2);

    b2 = double(fix((bitsra(bitxor(bitsll(s2,3),s2),11))));
    s2 = bitxor(bitsll(bitand(s2,0xFFFFFFF0),17),b2) ;
    random2 = bitxor(bitxor(s0,s1),s2);
   


    RandMax = 0xFFFFFFFF ;
    
    

    drand1 = (double(random1)+1)/(double(RandMax)+1);
    drand2 = (double(random2)+1)/(double(RandMax)+1);

    random(i) = real(sqrt(-2*log(drand1))*cos(2*3.1415926538979323846*drand2))*var;
    noise_output(i) = random(i)+bpsk(i);
end





